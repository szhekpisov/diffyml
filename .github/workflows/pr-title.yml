name: PR Title

permissions: read-all

on:
  pull_request:
    types: [opened, edited, synchronize]

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Check PR title convention
        env:
          PR_TITLE: ${{ github.event.pull_request.title }}
        run: |
          if [[ ! "$PR_TITLE" =~ ^(feat|bug|doc|chore|test):\ .+ ]]; then
            echo "::error::PR title must start with: feat: / bug: / doc: / chore: / test:"
            echo ""
            echo "Examples:"
            echo "  feat: add remote URL support"
            echo "  bug: fix K8s resource matching for namespaced resources"
            echo "  doc: update contributing guidelines"
            echo "  chore: bump gopkg.in/yaml.v3 to v3.1.0"
            echo "  test: add fixture for directory comparison"
            exit 1
          fi
          echo "PR title is valid: $PR_TITLE"
